{% extends "base.html" %}
{% block content %}

<h1 class="page-title">Job Applications</h1>
<p class="subtitle">Review and manage candidate applications</p>

<div class="action-bar">
    <input type="text"
           id="searchInput"
           placeholder="Search applications..."
           onkeyup="searchApplications()"
           class="search-input">

    <a href="/download-excel">
        <button>Download Excel</button>
    </a>
</div>

<div class="card">
    <table id="applicationsTable">
        <thead>
            <tr>
                <th>Job</th>
                <th>Applicant</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Resume</th>
            </tr>
        </thead>

        <tbody>
        {% for app in applications %}
            <tr>
                <td>{{ app.job_title }}</td>
                <td>{{ app.applicant_name }}</td>
                <td>{{ app.email }}</td>
                <td>{{ app.phone }}</td>
                <td>
                    {% if app.resume_url %}
                        <a href="{{ app.resume_url }}" target="_blank">Open Resume</a>
                    {% else %}
                        No Resume
                    {% endif %}
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="5" style="text-align:center;">No applications</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

<script>
function searchApplications() {
    const input = document.getElementById("searchInput").value.toLowerCase();
    document.querySelectorAll("#applicationsTable tbody tr").forEach(row => {
        row.style.display = row.innerText.toLowerCase().includes(input) ? "" : "none";
    });
}
</script>

{% endblock %}
